/*! For license information please see app.min.js.LICENSE.txt */
(()=>{"use strict";class e{constructor(){let{button:e='[data-dropdown="button"]',container:t='[data-dropdown="wrapper"]',openClass:i="is-open",onOpen:s=(()=>{}),onClose:l=(()=>{})}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.button=e,this.options={container:t,openClass:i,onOpen:s,onClose:l},this._init()}_init(){const e=document.querySelectorAll(this.button);e&&(e.forEach((e=>{e.addEventListener("click",this._handleClick.bind(this))})),document.addEventListener("click",this._handleClickOutside.bind(this)))}_handleClick(e){e.preventDefault();const t=e.target.closest(this.options.container);t&&(t.classList.contains(this.options.openClass)?this._close(t):this._open(t))}_handleClickOutside(){document.querySelectorAll(`${this.options.container}.${this.options.openClass}`).forEach((e=>{e.contains(event.target)||this._close(e)}))}_open(e){e.classList.add(this.options.openClass),this.options.onOpen&&this.options.onOpen()}_close(e){e.classList.remove(this.options.openClass),this.options.onClose&&this.options.onClose()}}var t=!1;if("undefined"!=typeof window){var i={get passive(){t=!0}};window.addEventListener("testPassive",null,i),window.removeEventListener("testPassive",null,i)}var s="undefined"!=typeof window&&window.navigator&&window.navigator.platform&&(/iP(ad|hone|od)/.test(window.navigator.platform)||"MacIntel"===window.navigator.platform&&window.navigator.maxTouchPoints>1),l=[],r=!1,o=-1,a=void 0,n=void 0,d=void 0,c=function(e){return l.some((function(t){return!(!t.options.allowTouchMove||!t.options.allowTouchMove(e))}))},u=function(e){var t=e||window.event;return!!c(t.target)||(t.touches.length>1||(t.preventDefault&&t.preventDefault(),!1))},h=function(){void 0!==d&&(document.body.style.paddingRight=d,d=void 0),void 0!==a&&(document.body.style.overflow=a,a=void 0)},f=function(){if(void 0!==n){var e=-parseInt(document.body.style.top,10),t=-parseInt(document.body.style.left,10);document.body.style.position=n.position,document.body.style.top=n.top,document.body.style.left=n.left,window.scrollTo(t,e),n=void 0}},b=function(e,i){if(e){if(!l.some((function(t){return t.targetElement===e}))){var h={targetElement:e,options:i||{}};l=[].concat(function(e){if(Array.isArray(e)){for(var t=0,i=Array(e.length);t<e.length;t++)i[t]=e[t];return i}return Array.from(e)}(l),[h]),s?window.requestAnimationFrame((function(){if(void 0===n){n={position:document.body.style.position,top:document.body.style.top,left:document.body.style.left};var e=window,t=e.scrollY,i=e.scrollX,s=e.innerHeight;document.body.style.position="fixed",document.body.style.top=-t,document.body.style.left=-i,setTimeout((function(){return window.requestAnimationFrame((function(){var e=s-window.innerHeight;e&&t>=s&&(document.body.style.top=-(t+e))}))}),300)}})):function(e){if(void 0===d){var t=!!e&&!0===e.reserveScrollBarGap,i=window.innerWidth-document.documentElement.clientWidth;if(t&&i>0){var s=parseInt(window.getComputedStyle(document.body).getPropertyValue("padding-right"),10);d=document.body.style.paddingRight,document.body.style.paddingRight=s+i+"px"}}void 0===a&&(a=document.body.style.overflow,document.body.style.overflow="hidden")}(i),s&&(e.ontouchstart=function(e){1===e.targetTouches.length&&(o=e.targetTouches[0].clientY)},e.ontouchmove=function(t){1===t.targetTouches.length&&function(e,t){var i=e.targetTouches[0].clientY-o;!c(e.target)&&(t&&0===t.scrollTop&&i>0||function(e){return!!e&&e.scrollHeight-e.scrollTop<=e.clientHeight}(t)&&i<0?u(e):e.stopPropagation())}(t,e)},r||(document.addEventListener("touchmove",u,t?{passive:!1}:void 0),r=!0))}}else console.error("disableBodyScroll unsuccessful - targetElement must be provided when calling disableBodyScroll on IOS devices.")},g=function(e){e?(l=l.filter((function(t){return t.targetElement!==e})),s&&(e.ontouchstart=null,e.ontouchmove=null,r&&0===l.length&&(document.removeEventListener("touchmove",u,t?{passive:!1}:void 0),r=!1)),s?f():h()):console.error("enableBodyScroll unsuccessful - targetElement must be provided when calling enableBodyScroll on IOS devices.")};const v=()=>{const e=document.querySelector(".add-form__input"),t=document.querySelector(".add-form__label"),i=document.querySelector(".file-return"),s=document.getElementById("file-btn");e&&(t.addEventListener("click",(t=>(e.focus(),!1))),e.addEventListener("change",(function(e){i.innerHTML=this.files[0].name,s.classList.remove("disabled")})))},m=()=>{const e=document?.querySelector("[data-burger]"),t=document?.querySelector("[data-menu]");document.querySelector("body");e?.addEventListener("click",(()=>{e?.classList.toggle("burger--active"),t?.classList.toggle("active"),t?.classList.contains("active")?(e?.setAttribute("aria-expanded","true"),e?.setAttribute("aria-label","Сlose menu"),function(){const e=window.scrollY;document.body.classList.add("scroll"),document.body.dataset.position=e}()):(e?.setAttribute("aria-expanded","false"),e?.setAttribute("aria-label","Open menu"),document.body.classList.remove("scroll"),document.body.removeAttribute("data-position"))}))},p=()=>{class e{constructor(e){this.root=e,this.list=this.root.querySelector(":scope > [data-list]"),this.buttons=new Map([...this.list.querySelectorAll(":scope > [data-target]")].map((e=>[e.dataset.target,e]))),this.containers=new Map([...this.root.querySelectorAll(":scope > [data-tab]")].map((e=>[e.dataset.tab,e]))),this.salt=Math.random().toString(36).slice(2),this.current=null,this.active=null}static create(t){const i=new e(t);return i.init(),i}select(e){const t=[...this.buttons.keys()];for(const[t,i]of this.buttons.entries())t===e?i.classList.add("active"):i.classList.remove("active");for(const[t,i]of this.containers.entries())t===e?i.classList.add("active"):i.classList.remove("active");this.active=t.indexOf(e)}init(){const e=[...this.buttons.keys()];this.list.setAttribute("role","tablist"),this.list.addEventListener("keydown",(t=>{"Home"===t.code&&(t.preventDefault(),this.buttons.get(e[0]).focus()),"End"===t.code&&(t.preventDefault(),this.buttons.get(e[e.length-1]).focus()),"ArrowLeft"===t.code&&(t.preventDefault(),this.buttons.get(e[Math.max(0,this.current-1)]).focus()),"ArrowRight"===t.code&&(t.preventDefault(),this.buttons.get(e[Math.min(e.length-1,this.current+1)]).focus())}));for(const[t,i]of this.buttons.entries())i.setAttribute("tabindex","0"),i.setAttribute("id",`button_${this.salt}_${t}`),i.setAttribute("role","tab"),i.setAttribute("aria-controls",`container_${this.salt}_${t}`),i.addEventListener("click",(e=>{e.preventDefault(),this.select(t)})),i.addEventListener("focus",(i=>{this.current=e.indexOf(t)})),i.addEventListener("keypress",(e=>{"Enter"!==e.code&&"Space"!==e.code||(e.preventDefault(),this.select(t))}));for(const[e,t]of this.containers.entries())t.setAttribute("id",`container_${this.salt}_${e}`),t.setAttribute("role","tabpanel"),t.setAttribute("aria-labelledby",`button_${this.salt}_${e}`);this.select(e[0])}}const t=document.querySelectorAll("[data-tabs]");for(const i of t){e.create(i)}},y=".js-select-btn",F=".js-select-list",L=".js-select-option",w="active",C=document.querySelectorAll(".js-select"),S=()=>{function e(){const e=document.querySelectorAll(y),t=document.querySelectorAll(F);e.forEach((e=>e.classList.remove(w))),t.forEach((e=>e.classList.remove(w)))}C.length&&(C.forEach((t=>{const i=t.querySelector(y),s=t.querySelector(F),l=s.querySelectorAll(L);i.addEventListener("click",(t=>{const i=t.target.closest(y);i.classList.contains(w)?(i.classList.remove(w),s.classList.remove(w)):(e(),i.classList.add(w),s.classList.add(w))})),s.addEventListener("click",(e=>{const t=e.target.closest(L);if(t){const e=t.getAttribute("data-value"),r=t.innerHTML;l.forEach((e=>e.classList.remove(w))),t.classList.add(w),i.classList.remove(w),i.innerHTML=r,i.setAttribute("data-value",e),s.classList.remove(w)}}))})),document.addEventListener("click",(t=>{const{target:i}=t;i&&!i.closest(".js-select")&&e()})))},E=()=>{document.querySelectorAll(".js-smooth-scroll").forEach((e=>{e.addEventListener("click",(function(){!function(e,t){const i=document.querySelector(e).getBoundingClientRect().top,s=window.pageYOffset;let l=null;const r=function(e){null===l&&(l=e);const o=e-l,a=(n=o,d=s,c=i,(n/=t/2)<1?c/2*n*n+d:-c/2*((n-=1)*(n-2)-1)+d);var n,d,c;window.scrollTo(120,a),o<t&&requestAnimationFrame(r)};requestAnimationFrame(r)}(this.getAttribute("href"),1e3)}))}))},k=()=>{const e=document.querySelectorAll(".accordion");let t=null;e.forEach((e=>{e.addEventListener("click",(e=>{const i=e.currentTarget,s=i.querySelector(".accordion__control"),l=i.querySelector(".accordion__content");if(i===t)i.classList.remove("open"),s.setAttribute("aria-expanded",!1),l.setAttribute("aria-hidden",!0),t=null;else{if(t){const e=t.querySelector(".accordion__control"),i=t.querySelector(".accordion__content");t.classList.remove("open"),e.setAttribute("aria-expanded",!1),i.setAttribute("aria-hidden",!0)}i.classList.add("open"),s.setAttribute("aria-expanded",!0),l.setAttribute("aria-hidden",!1),t=i}}))}))},M=document.querySelectorAll(".js-show-popup"),x=document.querySelectorAll(".js-popup"),{body:V}=document,A=document.querySelector(".js-overlay"),q="active",T="overflow",I=(()=>{const e=e=>{e&&(V.classList.remove(T),A.classList.remove(q),e.classList.remove(q),document.querySelector(".active[data-content]")&&document.querySelector(".active[data-tab]")&&(document.querySelector(".active[data-content]").classList.remove(q),document.querySelector(".active[data-tab]").classList.remove(q)))},t=()=>{M.length&&M.forEach((e=>{e.addEventListener("click",(e=>{(e=>{const t=e.target.closest(".js-show-popup"),i=document.querySelector(".js-popup.active"),s=document.querySelector(`[data-popup=${t.dataset.trigger}]`);i&&i.classList.remove(q),t.dataset.tab&&(s.querySelector(`[data-tab="${t.dataset.tab}"]`).classList.add(q),s.querySelector(`[data-content="${t.dataset.tab}"]`).classList.add(q)),s.classList.add(q),V.classList.add(T),A.classList.add(q)})(e),b(V)}))})),A&&A.addEventListener("click",(()=>{e(document.querySelector(".js-popup.active")),g(V)})),x.length&&x.forEach((t=>{t.addEventListener("click",(i=>{i.target.closest(".js-popup-close")&&(e(t),g(V))}))}))};return{init:()=>{x.length&&t()}}})();var j=Object.defineProperty,$=(e,t,i)=>(((e,t,i)=>{t in e?j(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i})(e,"symbol"!=typeof t?t+"":t,i),i);const P=/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,O=/^-?[0-9]\d*$/,_=/^(?=.*[A-Za-z])(?=.*\d).{8,}$/,G=/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$/,N=e=>"string"!=typeof e||""===e;var B=(e=>(e.Required="required",e.Email="email",e.MinLength="minLength",e.MaxLength="maxLength",e.Password="password",e.Number="number",e.Integer="integer",e.MaxNumber="maxNumber",e.MinNumber="minNumber",e.StrongPassword="strongPassword",e.CustomRegexp="customRegexp",e.MinFilesCount="minFilesCount",e.MaxFilesCount="maxFilesCount",e.Files="files",e))(B||{}),R=(e=>(e.Required="required",e))(R||{}),D=(e=>(e.Label="label",e.LabelArrow="labelArrow",e))(D||{});const z=[{key:B.Required,dict:{en:"The field is required"}},{key:B.Email,dict:{en:"Email has invalid format"}},{key:B.MaxLength,dict:{en:"The field must contain a maximum of :value characters"}},{key:B.MinLength,dict:{en:"The field must contain a minimum of :value characters"}},{key:B.Password,dict:{en:"Password must contain minimum eight characters, at least one letter and one number"}},{key:B.StrongPassword,dict:{en:"Password should contain minimum eight characters, at least one uppercase letter, one lowercase letter, one number and one special character"}},{key:B.Number,dict:{en:"Value should be a number"}},{key:B.MaxNumber,dict:{en:"Number should be less or equal than :value"}},{key:B.MinNumber,dict:{en:"Number should be more or equal than :value"}},{key:B.MinFilesCount,dict:{en:"Files count should be more or equal than :value"}},{key:B.MaxFilesCount,dict:{en:"Files count should be less or equal than :value"}},{key:B.Files,dict:{en:"Uploaded files have one or several invalid properties (extension/size/type etc)."}}],H=e=>"object"==typeof e&&null!==e&&"then"in e&&"function"==typeof e.then,K=e=>Array.isArray(e)?e.filter((e=>e.length>0)):"string"==typeof e&&e.trim()?[...e.split(" ").filter((e=>e.length>0))]:[],Y=e=>e instanceof Element||e instanceof HTMLDocument,Z={errorFieldStyle:{color:"#b81111",border:"1px solid #B81111"},errorFieldCssClass:"just-validate-error-field",successFieldCssClass:"just-validate-success-field",errorLabelStyle:{color:"#b81111"},errorLabelCssClass:"just-validate-error-label",successLabelCssClass:"just-validate-success-label",focusInvalidField:!0,lockForm:!0,testingMode:!1,validateBeforeSubmitting:!1};class X{constructor(e,t,i){$(this,"form",null),$(this,"fields",{}),$(this,"groupFields",{}),$(this,"errors",{}),$(this,"isValid",!1),$(this,"isSubmitted",!1),$(this,"globalConfig",Z),$(this,"errorLabels",{}),$(this,"successLabels",{}),$(this,"eventListeners",[]),$(this,"dictLocale",z),$(this,"currentLocale","en"),$(this,"customStyleTags",{}),$(this,"onSuccessCallback"),$(this,"onFailCallback"),$(this,"onValidateCallback"),$(this,"tooltips",[]),$(this,"lastScrollPosition"),$(this,"isScrollTick"),$(this,"fieldIds",new Map),$(this,"getKeyByFieldSelector",(e=>this.fieldIds.get(e))),$(this,"getFieldSelectorByKey",(e=>{for(const[t,i]of this.fieldIds)if(e===i)return t})),$(this,"getCompatibleFields",(()=>{const e={};return Object.keys(this.fields).forEach((t=>{let i=t;const s=this.getFieldSelectorByKey(t);"string"==typeof s&&(i=s),e[i]={...this.fields[t]}})),e})),$(this,"setKeyByFieldSelector",(e=>{if(this.fieldIds.has(e))return this.fieldIds.get(e);const t=String(this.fieldIds.size+1);return this.fieldIds.set(e,t),t})),$(this,"refreshAllTooltips",(()=>{this.tooltips.forEach((e=>{e.refresh()}))})),$(this,"handleDocumentScroll",(()=>{this.lastScrollPosition=window.scrollY,this.isScrollTick||(window.requestAnimationFrame((()=>{this.refreshAllTooltips(),this.isScrollTick=!1})),this.isScrollTick=!0)})),$(this,"formSubmitHandler",(e=>{e.preventDefault(),this.isSubmitted=!0,this.validateHandler(e)})),$(this,"handleFieldChange",(e=>{let t;for(const i in this.fields){if(this.fields[i].elem===e){t=i;break}}t&&(this.fields[t].touched=!0,this.validateField(t,!0))})),$(this,"handleGroupChange",(e=>{let t;for(const i in this.groupFields){if(this.groupFields[i].elems.find((t=>t===e))){t=i;break}}t&&(this.groupFields[t].touched=!0,this.validateGroup(t,!0))})),$(this,"handlerChange",(e=>{e.target&&(this.handleFieldChange(e.target),this.handleGroupChange(e.target),this.renderErrors())})),this.initialize(e,t,i)}initialize(e,t,i){if(this.form=null,this.errors={},this.isValid=!1,this.isSubmitted=!1,this.globalConfig=Z,this.errorLabels={},this.successLabels={},this.eventListeners=[],this.customStyleTags={},this.tooltips=[],this.currentLocale="en","string"==typeof e){const t=document.querySelector(e);if(!t)throw Error(`Form with ${e} selector not found! Please check the form selector`);this.setForm(t)}else{if(!(e instanceof HTMLFormElement))throw Error("Form selector is not valid. Please specify a string selector or a DOM element.");this.setForm(e)}if(this.globalConfig={...Z,...t},i&&(this.dictLocale=[...i,...z]),this.isTooltip()){const e=document.createElement("style");e.textContent=".just-validate-error-label[data-tooltip=true]{position:fixed;padding:4px 8px;background:#423f3f;color:#fff;white-space:nowrap;z-index:10;border-radius:4px;transform:translateY(-5px)}.just-validate-error-label[data-tooltip=true]:before{content:'';width:0;height:0;border-left:solid 5px transparent;border-right:solid 5px transparent;border-bottom:solid 5px #423f3f;position:absolute;z-index:3;display:block;bottom:-5px;transform:rotate(180deg);left:calc(50% - 5px)}.just-validate-error-label[data-tooltip=true][data-direction=left]{transform:translateX(-5px)}.just-validate-error-label[data-tooltip=true][data-direction=left]:before{right:-7px;bottom:auto;left:auto;top:calc(50% - 2px);transform:rotate(90deg)}.just-validate-error-label[data-tooltip=true][data-direction=right]{transform:translateX(5px)}.just-validate-error-label[data-tooltip=true][data-direction=right]:before{right:auto;bottom:auto;left:-7px;top:calc(50% - 2px);transform:rotate(-90deg)}.just-validate-error-label[data-tooltip=true][data-direction=bottom]{transform:translateY(5px)}.just-validate-error-label[data-tooltip=true][data-direction=bottom]:before{right:auto;bottom:auto;left:calc(50% - 5px);top:-5px;transform:rotate(0)}",this.customStyleTags[D.Label]=document.head.appendChild(e),this.addListener("scroll",document,this.handleDocumentScroll)}}getLocalisedString(e,t,i){var s;const l=null!=i?i:e;let r=null==(s=this.dictLocale.find((e=>e.key===l)))?void 0:s.dict[this.currentLocale];if(r||i&&(r=i),r&&void 0!==t)switch(e){case B.MaxLength:case B.MinLength:case B.MaxNumber:case B.MinNumber:case B.MinFilesCount:case B.MaxFilesCount:r=r.replace(":value",String(t))}return r||i||"Value is incorrect"}getFieldErrorMessage(e,t){const i="function"==typeof e.errorMessage?e.errorMessage(this.getElemValue(t),this.fields):e.errorMessage;return this.getLocalisedString(e.rule,e.value,i)}getFieldSuccessMessage(e,t){const i="function"==typeof e?e(this.getElemValue(t),this.fields):e;return this.getLocalisedString(void 0,void 0,i)}getGroupErrorMessage(e){return this.getLocalisedString(e.rule,void 0,e.errorMessage)}getGroupSuccessMessage(e){if(e.successMessage)return this.getLocalisedString(void 0,void 0,e.successMessage)}setFieldInvalid(e,t){this.fields[e].isValid=!1,this.fields[e].errorMessage=this.getFieldErrorMessage(t,this.fields[e].elem)}setFieldValid(e,t){this.fields[e].isValid=!0,void 0!==t&&(this.fields[e].successMessage=this.getFieldSuccessMessage(t,this.fields[e].elem))}setGroupInvalid(e,t){this.groupFields[e].isValid=!1,this.groupFields[e].errorMessage=this.getGroupErrorMessage(t)}setGroupValid(e,t){this.groupFields[e].isValid=!0,this.groupFields[e].successMessage=this.getGroupSuccessMessage(t)}getElemValue(e){switch(e.type){case"checkbox":return e.checked;case"file":return e.files;default:return e.value}}validateGroupRule(e,t,i){if(i.rule===R.Required)t.every((e=>!e.checked))?this.setGroupInvalid(e,i):this.setGroupValid(e,i)}validateFieldRule(e,t,i,s=!1){const l=i.value,r=this.getElemValue(t);if(i.plugin){i.plugin(r,this.getCompatibleFields())||this.setFieldInvalid(e,i)}else{switch(i.rule){case B.Required:(e=>{let t=e;return"string"==typeof e&&(t=e.trim()),!t})(r)&&this.setFieldInvalid(e,i);break;case B.Email:if(N(r))break;o=r,P.test(o)||this.setFieldInvalid(e,i);break;case B.MaxLength:if(void 0===l){console.error(`Value for ${i.rule} rule for [${e}] field is not defined. The field will be always invalid.`),this.setFieldInvalid(e,i);break}if("number"!=typeof l){console.error(`Value for ${i.rule} rule for [${e}] should be a number. The field will be always invalid.`),this.setFieldInvalid(e,i);break}if(N(r))break;((e,t)=>e.length>t)(r,l)&&this.setFieldInvalid(e,i);break;case B.MinLength:if(void 0===l){console.error(`Value for ${i.rule} rule for [${e}] field is not defined. The field will be always invalid.`),this.setFieldInvalid(e,i);break}if("number"!=typeof l){console.error(`Value for ${i.rule} rule for [${e}] should be a number. The field will be always invalid.`),this.setFieldInvalid(e,i);break}if(N(r))break;((e,t)=>e.length<t)(r,l)&&this.setFieldInvalid(e,i);break;case B.Password:if(N(r))break;(e=>_.test(e))(r)||this.setFieldInvalid(e,i);break;case B.StrongPassword:if(N(r))break;(e=>G.test(e))(r)||this.setFieldInvalid(e,i);break;case B.Number:if(N(r))break;(e=>"string"==typeof e&&!isNaN(+e)&&!isNaN(parseFloat(e)))(r)||this.setFieldInvalid(e,i);break;case B.Integer:if(N(r))break;(e=>O.test(e))(r)||this.setFieldInvalid(e,i);break;case B.MaxNumber:{if(void 0===l){console.error(`Value for ${i.rule} rule for [${e}] field is not defined. The field will be always invalid.`),this.setFieldInvalid(e,i);break}if("number"!=typeof l){console.error(`Value for ${i.rule} rule for [${e}] field should be a number. The field will be always invalid.`),this.setFieldInvalid(e,i);break}if(N(r))break;const t=+r;(Number.isNaN(t)||((e,t)=>e>t)(t,l))&&this.setFieldInvalid(e,i);break}case B.MinNumber:{if(void 0===l){console.error(`Value for ${i.rule} rule for [${e}] field is not defined. The field will be always invalid.`),this.setFieldInvalid(e,i);break}if("number"!=typeof l){console.error(`Value for ${i.rule} rule for [${e}] field should be a number. The field will be always invalid.`),this.setFieldInvalid(e,i);break}if(N(r))break;const t=+r;(Number.isNaN(t)||((e,t)=>e<t)(t,l))&&this.setFieldInvalid(e,i);break}case B.CustomRegexp:{if(void 0===l)return console.error(`Value for ${i.rule} rule for [${e}] field is not defined. This field will be always invalid.`),void this.setFieldInvalid(e,i);let t;try{t=new RegExp(l)}catch(t){console.error(`Value for ${i.rule} rule for [${e}] should be a valid regexp. This field will be always invalid.`),this.setFieldInvalid(e,i);break}const s=String(r);""===s||t.test(s)||this.setFieldInvalid(e,i);break}case B.MinFilesCount:if(void 0===l){console.error(`Value for ${i.rule} rule for [${e}] field is not defined. This field will be always invalid.`),this.setFieldInvalid(e,i);break}if("number"!=typeof l){console.error(`Value for ${i.rule} rule for [${e}] field should be a number. The field will be always invalid.`),this.setFieldInvalid(e,i);break}if(Number.isFinite(null==r?void 0:r.length)&&r.length<l){this.setFieldInvalid(e,i);break}break;case B.MaxFilesCount:if(void 0===l){console.error(`Value for ${i.rule} rule for [${e}] field is not defined. This field will be always invalid.`),this.setFieldInvalid(e,i);break}if("number"!=typeof l){console.error(`Value for ${i.rule} rule for [${e}] field should be a number. The field will be always invalid.`),this.setFieldInvalid(e,i);break}if(Number.isFinite(null==r?void 0:r.length)&&r.length>l){this.setFieldInvalid(e,i);break}break;case B.Files:{if(void 0===l)return console.error(`Value for ${i.rule} rule for [${e}] field is not defined. This field will be always invalid.`),void this.setFieldInvalid(e,i);if("object"!=typeof l)return console.error(`Value for ${i.rule} rule for [${e}] field should be an object. This field will be always invalid.`),void this.setFieldInvalid(e,i);const t=l.files;if("object"!=typeof t)return console.error(`Value for ${i.rule} rule for [${e}] field should be an object with files array. This field will be always invalid.`),void this.setFieldInvalid(e,i);const s=(e,t)=>{const i=Number.isFinite(t.minSize)&&e.size<t.minSize,s=Number.isFinite(t.maxSize)&&e.size>t.maxSize,l=Array.isArray(t.names)&&!t.names.includes(e.name),r=Array.isArray(t.extensions)&&!t.extensions.includes(e.name.split(".")[e.name.split(".").length-1]),o=Array.isArray(t.types)&&!t.types.includes(e.type);return i||s||l||r||o};if("object"==typeof r&&null!==r)for(let l=0,o=r.length;l<o;++l){const o=r.item(l);if(!o){this.setFieldInvalid(e,i);break}if(s(o,t)){this.setFieldInvalid(e,i);break}}break}default:{if("function"!=typeof i.validator)return console.error(`Validator for custom rule for [${e}] field should be a function. This field will be always invalid.`),void this.setFieldInvalid(e,i);const t=i.validator(r,this.getCompatibleFields());if("boolean"!=typeof t&&"function"!=typeof t&&console.error(`Validator return value for [${e}] field should be boolean or function. It will be cast to boolean.`),"function"==typeof t){if(!s){this.fields[e].asyncCheckPending=!1;const s=t();return H(s)?s.then((t=>{t||this.setFieldInvalid(e,i)})).catch((()=>{this.setFieldInvalid(e,i)})):(console.error(`Validator function for custom rule for [${e}] field should return a Promise. This field will be always invalid.`),void this.setFieldInvalid(e,i))}this.fields[e].asyncCheckPending=!0}t||this.setFieldInvalid(e,i)}}var o}}isFormValid(){let e=!0;for(let t=0,i=Object.values(this.fields).length;t<i;++t){const i=Object.values(this.fields)[t];if(void 0===i.isValid){e=void 0;break}if(!1===i.isValid){e=!1;break}}for(let t=0,i=Object.values(this.groupFields).length;t<i;++t){const i=Object.values(this.groupFields)[t];if(void 0===i.isValid){e=void 0;break}if(!1===i.isValid){e=!1;break}}return e}validateField(e,t=!1){var i;const s=this.fields[e];s.isValid=!0;const l=[];return[...s.rules].reverse().forEach((i=>{const r=this.validateFieldRule(e,s.elem,i,t);H(r)&&l.push(r)})),s.isValid&&this.setFieldValid(e,null==(i=s.config)?void 0:i.successMessage),Promise.allSettled(l).finally((()=>{var e;t&&(null==(e=this.onValidateCallback)||e.call(this,{isValid:this.isFormValid(),isSubmitted:this.isSubmitted,fields:this.getCompatibleFields(),groups:{...this.groupFields}}))}))}revalidateField(e){if("string"!=typeof e&&!Y(e))throw Error("Field selector is not valid. Please specify a string selector or a valid DOM element.");const t=this.getKeyByFieldSelector(e);return t&&this.fields[t]?new Promise((e=>{this.validateField(t,!0).finally((()=>{this.clearFieldStyle(t),this.clearFieldLabel(t),this.renderFieldError(t,!0),e(!!this.fields[t].isValid)}))})):(console.error("Field not found. Check the field selector."),Promise.reject())}revalidateGroup(e){if("string"!=typeof e&&!Y(e))throw Error("Group selector is not valid. Please specify a string selector or a valid DOM element.");const t=this.getKeyByFieldSelector(e);return t&&this.groupFields[t]?new Promise((e=>{this.validateGroup(t).finally((()=>{this.clearFieldLabel(t),this.renderGroupError(t,!0),e(!!this.groupFields[t].isValid)}))})):(console.error("Group not found. Check the group selector."),Promise.reject())}validateGroup(e,t=!1){const i=this.groupFields[e],s=[];return[...i.rules].reverse().forEach((t=>{const l=this.validateGroupRule(e,i.elems,t);H(l)&&s.push(l)})),Promise.allSettled(s).finally((()=>{var e;t&&(null==(e=this.onValidateCallback)||e.call(this,{isValid:this.isFormValid(),isSubmitted:this.isSubmitted,fields:this.getCompatibleFields(),groups:{...this.groupFields}}))}))}focusInvalidField(){for(const e in this.fields){const t=this.fields[e];if(!t.isValid){setTimeout((()=>t.elem.focus()),0);break}}}afterSubmitValidation(e=!1){this.renderErrors(e),this.globalConfig.focusInvalidField&&this.focusInvalidField()}validate(e=!1){return new Promise((t=>{const i=[];Object.keys(this.fields).forEach((e=>{const t=this.validateField(e);H(t)&&i.push(t)})),Object.keys(this.groupFields).forEach((e=>{const t=this.validateGroup(e);H(t)&&i.push(t)})),Promise.allSettled(i).then((()=>{var s;this.afterSubmitValidation(e),null==(s=this.onValidateCallback)||s.call(this,{isValid:this.isFormValid(),isSubmitted:this.isSubmitted,fields:this.getCompatibleFields(),groups:{...this.groupFields}}),t(!!i.length)}))}))}revalidate(){return new Promise((e=>{this.validateHandler(void 0,!0).finally((()=>{this.globalConfig.focusInvalidField&&this.focusInvalidField(),e(this.isValid)}))}))}validateHandler(e,t=!1){return this.globalConfig.lockForm&&this.lockForm(),this.validate(t).finally((()=>{var t,i;this.globalConfig.lockForm&&this.unlockForm(),this.isValid?null==(t=this.onSuccessCallback)||t.call(this,e):null==(i=this.onFailCallback)||i.call(this,this.getCompatibleFields(),this.groupFields)}))}setForm(e){this.form=e,this.form.setAttribute("novalidate","novalidate"),this.removeListener("submit",this.form,this.formSubmitHandler),this.addListener("submit",this.form,this.formSubmitHandler)}addListener(e,t,i){t.addEventListener(e,i),this.eventListeners.push({type:e,elem:t,func:i})}removeListener(e,t,i){t.removeEventListener(e,i),this.eventListeners=this.eventListeners.filter((i=>i.type!==e||i.elem!==t))}addField(e,t,i){if("string"!=typeof e&&!Y(e))throw Error("Field selector is not valid. Please specify a string selector or a valid DOM element.");let s;if(s="string"==typeof e?this.form.querySelector(e):e,!s)throw Error("Field doesn't exist in the DOM! Please check the field selector.");if(!Array.isArray(t)||!t.length)throw Error("Rules argument should be an array and should contain at least 1 element.");t.forEach((e=>{if(!("rule"in e||"validator"in e||"plugin"in e))throw Error("Rules argument must contain at least one rule or validator property.");if(!(e.validator||e.plugin||e.rule&&Object.values(B).includes(e.rule)))throw Error(`Rule should be one of these types: ${Object.values(B).join(", ")}. Provided value: ${e.rule}`)}));const l=this.setKeyByFieldSelector(e);return this.fields[l]={elem:s,rules:t,isValid:void 0,touched:!1,config:i},this.setListeners(s),(this.isSubmitted||this.globalConfig.validateBeforeSubmitting)&&this.validateField(l),this}removeField(e){if("string"!=typeof e&&!Y(e))throw Error("Field selector is not valid. Please specify a string selector or a valid DOM element.");const t=this.getKeyByFieldSelector(e);if(!t||!this.fields[t])return console.error("Field not found. Check the field selector."),this;const i=this.getListenerType(this.fields[t].elem.type);return this.removeListener(i,this.fields[t].elem,this.handlerChange),this.clearErrors(),delete this.fields[t],this}removeGroup(e){if("string"!=typeof e)throw Error("Group selector is not valid. Please specify a string selector.");const t=this.getKeyByFieldSelector(e);return t&&this.groupFields[t]?(this.groupFields[t].elems.forEach((e=>{const t=this.getListenerType(e.type);this.removeListener(t,e,this.handlerChange)})),this.clearErrors(),delete this.groupFields[t],this):(console.error("Group not found. Check the group selector."),this)}addRequiredGroup(e,t,i,s){if("string"!=typeof e&&!Y(e))throw Error("Group selector is not valid. Please specify a string selector or a valid DOM element.");let l;if(l="string"==typeof e?this.form.querySelector(e):e,!l)throw Error("Group selector not found! Please check the group selector.");const r=l.querySelectorAll("input"),o=Array.from(r).filter((e=>{const t=((e,t)=>{const i=[...t].reverse();for(let t=0,s=i.length;t<s;++t){const s=i[t];for(const t in e){const i=e[t];if(i.groupElem===s)return[t,i]}}return null})(this.groupFields,(e=>{let t=e;const i=[];for(;t;)i.unshift(t),t=t.parentNode;return i})(e));return!t||t[1].elems.find((t=>t!==e))})),a=this.setKeyByFieldSelector(e);return this.groupFields[a]={rules:[{rule:R.Required,errorMessage:t,successMessage:s}],groupElem:l,elems:o,touched:!1,isValid:void 0,config:i},r.forEach((e=>{this.setListeners(e)})),this}getListenerType(e){switch(e){case"checkbox":case"select-one":case"file":case"radio":return"change";default:return"input"}}setListeners(e){const t=this.getListenerType(e.type);this.removeListener(t,e,this.handlerChange),this.addListener(t,e,this.handlerChange)}clearFieldLabel(e){var t,i;null==(t=this.errorLabels[e])||t.remove(),null==(i=this.successLabels[e])||i.remove()}clearFieldStyle(e){var t,i,s,l;const r=this.fields[e],o=(null==(t=r.config)?void 0:t.errorFieldStyle)||this.globalConfig.errorFieldStyle;Object.keys(o).forEach((e=>{r.elem.style[e]=""}));const a=(null==(i=r.config)?void 0:i.successFieldStyle)||this.globalConfig.successFieldStyle||{};Object.keys(a).forEach((e=>{r.elem.style[e]=""})),r.elem.classList.remove(...K((null==(s=r.config)?void 0:s.errorFieldCssClass)||this.globalConfig.errorFieldCssClass),...K((null==(l=r.config)?void 0:l.successFieldCssClass)||this.globalConfig.successFieldCssClass))}clearErrors(){var e,t;Object.keys(this.errorLabels).forEach((e=>this.errorLabels[e].remove())),Object.keys(this.successLabels).forEach((e=>this.successLabels[e].remove()));for(const e in this.fields)this.clearFieldStyle(e);for(const i in this.groupFields){const s=this.groupFields[i],l=(null==(e=s.config)?void 0:e.errorFieldStyle)||this.globalConfig.errorFieldStyle;Object.keys(l).forEach((e=>{s.elems.forEach((t=>{var i;t.style[e]="",t.classList.remove(...K((null==(i=s.config)?void 0:i.errorFieldCssClass)||this.globalConfig.errorFieldCssClass))}))}));const r=(null==(t=s.config)?void 0:t.successFieldStyle)||this.globalConfig.successFieldStyle||{};Object.keys(r).forEach((e=>{s.elems.forEach((t=>{var i;t.style[e]="",t.classList.remove(...K((null==(i=s.config)?void 0:i.successFieldCssClass)||this.globalConfig.successFieldCssClass))}))}))}this.tooltips=[]}isTooltip(){return!!this.globalConfig.tooltip}lockForm(){const e=this.form.querySelectorAll("input, textarea, button, select");for(let t=0,i=e.length;t<i;++t)e[t].setAttribute("data-just-validate-fallback-disabled",e[t].disabled?"true":"false"),e[t].setAttribute("disabled","disabled"),e[t].style.pointerEvents="none",e[t].style.webkitFilter="grayscale(100%)",e[t].style.filter="grayscale(100%)"}unlockForm(){const e=this.form.querySelectorAll("input, textarea, button, select");for(let t=0,i=e.length;t<i;++t)"true"!==e[t].getAttribute("data-just-validate-fallback-disabled")&&e[t].removeAttribute("disabled"),e[t].style.pointerEvents="",e[t].style.webkitFilter="",e[t].style.filter=""}renderTooltip(e,t,i){var s;const{top:l,left:r,width:o,height:a}=e.getBoundingClientRect(),n=t.getBoundingClientRect(),d=i||(null==(s=this.globalConfig.tooltip)?void 0:s.position);switch(d){case"left":t.style.top=l+a/2-n.height/2+"px",t.style.left=r-n.width-5+"px";break;case"top":t.style.top=l-n.height-5+"px",t.style.left=r+o/2-n.width/2+"px";break;case"right":t.style.top=l+a/2-n.height/2+"px",t.style.left=`${r+o+5}px`;break;case"bottom":t.style.top=`${l+a+5}px`,t.style.left=r+o/2-n.width/2+"px"}t.dataset.direction=d;return{refresh:()=>{this.renderTooltip(e,t,i)}}}createErrorLabelElem(e,t,i){const s=document.createElement("div");s.innerHTML=t;const l=this.isTooltip()?null==i?void 0:i.errorLabelStyle:(null==i?void 0:i.errorLabelStyle)||this.globalConfig.errorLabelStyle;return Object.assign(s.style,l),s.classList.add(...K((null==i?void 0:i.errorLabelCssClass)||this.globalConfig.errorLabelCssClass),"just-validate-error-label"),this.isTooltip()&&(s.dataset.tooltip="true"),this.globalConfig.testingMode&&(s.dataset.testId=`error-label-${e}`),this.errorLabels[e]=s,s}createSuccessLabelElem(e,t,i){if(void 0===t)return null;const s=document.createElement("div");s.innerHTML=t;const l=(null==i?void 0:i.successLabelStyle)||this.globalConfig.successLabelStyle;return Object.assign(s.style,l),s.classList.add(...K((null==i?void 0:i.successLabelCssClass)||this.globalConfig.successLabelCssClass),"just-validate-success-label"),this.globalConfig.testingMode&&(s.dataset.testId=`success-label-${e}`),this.successLabels[e]=s,s}renderErrorsContainer(e,t){const i=t||this.globalConfig.errorsContainer;if("string"==typeof i){const t=this.form.querySelector(i);if(t)return t.appendChild(e),!0;console.error(`Error container with ${i} selector not found. Errors will be rendered as usual`)}return i instanceof Element?(i.appendChild(e),!0):(void 0!==i&&console.error("Error container not found. It should be a string or existing Element. Errors will be rendered as usual"),!1)}renderGroupLabel(e,t,i,s){if(!s){if(this.renderErrorsContainer(t,i))return}e.appendChild(t)}renderFieldLabel(e,t,i,s){var l,r,o,a,n,d,c;if(!s){if(this.renderErrorsContainer(t,i))return}if("checkbox"===e.type||"radio"===e.type){const i=document.querySelector(`label[for="${e.getAttribute("id")}"]`);"label"===(null==(r=null==(l=e.parentElement)?void 0:l.tagName)?void 0:r.toLowerCase())?null==(a=null==(o=e.parentElement)?void 0:o.parentElement)||a.appendChild(t):i?null==(n=i.parentElement)||n.appendChild(t):null==(d=e.parentElement)||d.appendChild(t)}else null==(c=e.parentElement)||c.appendChild(t)}showLabels(e,t){Object.keys(e).forEach(((i,s)=>{const l=e[i],r=this.getKeyByFieldSelector(i);if(!r||!this.fields[r])return void console.error("Field not found. Check the field selector.");const o=this.fields[r];o.isValid=!t,this.clearFieldStyle(r),this.clearFieldLabel(r),this.renderFieldError(r,!1,l),0===s&&this.globalConfig.focusInvalidField&&setTimeout((()=>o.elem.focus()),0)}))}showErrors(e){if("object"!=typeof e)throw Error("[showErrors]: Errors should be an object with key: value format");this.showLabels(e,!0)}showSuccessLabels(e){if("object"!=typeof e)throw Error("[showSuccessLabels]: Labels should be an object with key: value format");this.showLabels(e,!1)}renderFieldError(e,t=!1,i){var s,l,r,o,a,n;const d=this.fields[e];if(!1===d.isValid&&(this.isValid=!1),void 0===d.isValid||!t&&!this.isSubmitted&&!d.touched&&void 0===i)return;if(d.isValid){if(!d.asyncCheckPending){const t=this.createSuccessLabelElem(e,void 0!==i?i:d.successMessage,d.config);t&&this.renderFieldLabel(d.elem,t,null==(s=d.config)?void 0:s.errorsContainer,!0),d.elem.classList.add(...K((null==(l=d.config)?void 0:l.successFieldCssClass)||this.globalConfig.successFieldCssClass))}return}d.elem.classList.add(...K((null==(r=d.config)?void 0:r.errorFieldCssClass)||this.globalConfig.errorFieldCssClass));const c=this.createErrorLabelElem(e,void 0!==i?i:d.errorMessage,d.config);this.renderFieldLabel(d.elem,c,null==(o=d.config)?void 0:o.errorsContainer),this.isTooltip()&&this.tooltips.push(this.renderTooltip(d.elem,c,null==(n=null==(a=d.config)?void 0:a.tooltip)?void 0:n.position))}renderGroupError(e,t=!0){var i,s,l,r;const o=this.groupFields[e];if(!1===o.isValid&&(this.isValid=!1),void 0===o.isValid||!t&&!this.isSubmitted&&!o.touched)return;if(o.isValid){o.elems.forEach((e=>{var t,i;Object.assign(e.style,(null==(t=o.config)?void 0:t.successFieldStyle)||this.globalConfig.successFieldStyle),e.classList.add(...K((null==(i=o.config)?void 0:i.successFieldCssClass)||this.globalConfig.successFieldCssClass))}));const t=this.createSuccessLabelElem(e,o.successMessage,o.config);return void(t&&this.renderGroupLabel(o.groupElem,t,null==(i=o.config)?void 0:i.errorsContainer,!0))}this.isValid=!1,o.elems.forEach((e=>{var t,i;Object.assign(e.style,(null==(t=o.config)?void 0:t.errorFieldStyle)||this.globalConfig.errorFieldStyle),e.classList.add(...K((null==(i=o.config)?void 0:i.errorFieldCssClass)||this.globalConfig.errorFieldCssClass))}));const a=this.createErrorLabelElem(e,o.errorMessage,o.config);this.renderGroupLabel(o.groupElem,a,null==(s=o.config)?void 0:s.errorsContainer),this.isTooltip()&&this.tooltips.push(this.renderTooltip(o.groupElem,a,null==(r=null==(l=o.config)?void 0:l.tooltip)?void 0:r.position))}renderErrors(e=!1){if(this.isSubmitted||e||this.globalConfig.validateBeforeSubmitting){this.clearErrors(),this.isValid=!0;for(const e in this.groupFields)this.renderGroupError(e);for(const e in this.fields)this.renderFieldError(e)}}destroy(){this.eventListeners.forEach((e=>{this.removeListener(e.type,e.elem,e.func)})),Object.keys(this.customStyleTags).forEach((e=>{this.customStyleTags[e].remove()})),this.clearErrors(),this.globalConfig.lockForm&&this.unlockForm()}refresh(){this.destroy(),this.form?(this.initialize(this.form,this.globalConfig),Object.keys(this.fields).forEach((e=>{const t=this.getFieldSelectorByKey(e);t&&this.addField(t,[...this.fields[e].rules],this.fields[e].config)}))):console.error("Cannot initialize the library! Form is not defined")}setCurrentLocale(e){"string"==typeof e||void 0===e?(this.currentLocale=e,this.isSubmitted&&this.validate()):console.error("Current locale should be a string")}onSuccess(e){return this.onSuccessCallback=e,this}onFail(e){return this.onFailCallback=e,this}onValidate(e){return this.onValidateCallback=e,this}}const W=()=>{new X("#basic_form").addField("#basic_name",[{rule:"required",errorMessage:" Заполните поле"}]).addField("#basic_number",[{rule:"required",errorMessage:" Заполните поле"},{rule:"minLength",value:10,errorMessage:" Заполните поле"},{rule:"maxLength",value:20,errorMessage:" Заполните поле"}]).onSuccess((()=>{const e=document.querySelector(".popup--success"),t=document.querySelector(".js-overlay");e.classList.add("active"),t.classList.add("active")}));const e=document.querySelector(".tel");e.addEventListener("input",(t=>{const i=e.value.replace(/\D+/g,"");let s;s=e.value.includes("+8")||"8"===e.value[0]?"":"+";for(let e=0;e<i.length&&e<11;e++){switch(e){case 0:s+="7"===(l=i[e])?"7 (":"8"===l?"8 (":"9"===l?"7 (9":"7 (";continue;case 4:s+=") ";break;case 7:case 9:s+="-"}s+=i[e]}var l;e.value=s}))};!function(){new e,p(),v(),m(),S(),E(),k(),W(),I.init();const t=()=>{document.documentElement.style.setProperty("--app-height",`${window.innerHeight}px`)};window.addEventListener("resize",t),t()}()})();